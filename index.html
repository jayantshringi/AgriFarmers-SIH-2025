<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4CAF50">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Agrifarmers">
    
    <!-- Manifest with CROSSORIGIN for Chrome -->
    <link rel="manifest" href="manifest.json" crossorigin="use-credentials">
    
    <!-- Icons from CDN (100% guaranteed to work) -->
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/3153/3153839.png" type="image/png" sizes="144x144">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3153/3153839.png">
    
    <title>Agrifarmers - Farming Companion</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Basic Styles */
        * {
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            margin: 0;
            padding: 0;
            background: #f9f9f9;
        }
        
        /* Loading Screen */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .loader {
            width: 60px;
            height: 60px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #138808;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Page Transitions */
        .page {
            display: none;
            opacity: 0;
            animation: fadeIn 0.3s ease forwards;
        }
        
        .page.active {
            display: block;
            opacity: 1;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* PWA Install Button - ALWAYS VISIBLE */
        #pwa-install-button {
            position: fixed !important;
            bottom: 20px !important;
            right: 20px !important;
            z-index: 9999 !important;
            background: linear-gradient(135deg, #10b981, #059669) !important;
            color: white !important;
            border-radius: 50px !important;
            padding: 12px 20px !important;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.3) !important;
            border: none !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            transition: all 0.3s ease !important;
            font-weight: 600 !important;
            font-size: 14px !important;
        }
        
        #pwa-install-button:hover {
            transform: translateY(-3px) scale(1.05) !important;
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.4) !important;
            background: linear-gradient(135deg, #059669, #047857) !important;
        }
        
        #pwa-install-button i {
            font-size: 18px !important;
            margin-right: 8px !important;
        }
        
        /* Mobile Responsive */
        @media (max-width: 640px) {
            #pwa-install-button {
                bottom: 70px !important;
                right: 15px !important;
                padding: 14px 16px !important;
            }
            
            #pwa-install-button span {
                display: inline !important;
                font-size: 13px !important;
            }
        }
        
        /* Hide install button when app is installed */
        @media (display-mode: standalone) {
            #pwa-install-button {
                display: none !important;
            }
        }
        
        /* App Layout */
        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .app-content {
            flex: 1;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }
        
        /* Feature Cards */
        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 5px solid #10b981;
            transition: transform 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        /* Buttons */
        .btn-primary {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: border 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        
        /* Header */
        .app-header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .app-header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            font-weight: 700;
            color: #138808;
        }
        
        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding: 40px 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .welcome-icon {
            font-size: 60px;
            color: #138808;
            margin-bottom: 20px;
        }
        
        /* Footer */
        .app-footer {
            background: #138808;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: auto;
        }
        
        /* Toast */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 10000;
            animation: slideIn 0.3s ease;
            border-left: 4px solid #10b981;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
    
    <!-- PWA Installation Script -->
    <script>
        // Global PWA variables
        let deferredPrompt = null;
        let isAppInstalled = false;
        
        // Check if app is already installed
        function checkIfAppInstalled() {
            if (window.matchMedia('(display-mode: standalone)').matches || 
                window.navigator.standalone === true) {
                isAppInstalled = true;
                document.getElementById('pwa-install-button').style.display = 'none';
                return true;
            }
            return false;
        }
        
        // Show toast message
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}" 
                       style="color: ${type === 'success' ? '#10b981' : '#3b82f6'};"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        // Install PWA function
        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('âœ… User installed the PWA');
                        showToast('App installed successfully!', 'success');
                        document.getElementById('pwa-install-button').innerHTML = 
                            '<i class="fas fa-check"></i> <span>Installed!</span>';
                        document.getElementById('pwa-install-button').style.background = '#10b981';
                        setTimeout(() => {
                            document.getElementById('pwa-install-button').style.display = 'none';
                        }, 2000);
                        localStorage.setItem('pwaInstalled', 'true');
                        isAppInstalled = true;
                    } else {
                        console.log('âŒ User dismissed the install prompt');
                        showToast('You can install from the browser menu', 'info');
                    }
                    deferredPrompt = null;
                });
            } else {
                showToast('Install option available in browser menu', 'info');
            }
        }
        
        // Initialize PWA
        window.addEventListener('load', function() {
            console.log('ðŸŒ± AgriFarmers PWA Initializing...');
            
            // Check if already installed
            checkIfAppInstalled();
            
            // Listen for install prompt
            window.addEventListener('beforeinstallprompt', (e) => {
                console.log('âœ… PWA install prompt available');
                e.preventDefault();
                deferredPrompt = e;
                
                // Show install button immediately
                const installButton = document.getElementById('pwa-install-button');
                installButton.style.display = 'flex';
                installButton.innerHTML = '<i class="fas fa-download"></i> <span>Install App</span>';
                
                // Auto-show prompt after 5 seconds if not shown before
                if (!localStorage.getItem('pwaPromptShown')) {
                    setTimeout(() => {
                        if (deferredPrompt && !isAppInstalled) {
                            installPWA();
                            localStorage.setItem('pwaPromptShown', 'true');
                        }
                    }, 5000);
                }
            });
            
            // Listen for app installation
            window.addEventListener('appinstalled', () => {
                console.log('ðŸŽ‰ PWA was installed');
                isAppInstalled = true;
                document.getElementById('pwa-install-button').style.display = 'none';
                localStorage.setItem('pwaInstalled', 'true');
            });
            
            // Register Service Worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => {
                        console.log('âœ… Service Worker registered:', reg.scope);
                        localStorage.setItem('serviceWorker', 'registered');
                        
                        // Check if we should show install button
                        setTimeout(() => {
                            if (deferredPrompt && !isAppInstalled) {
                                document.getElementById('pwa-install-button').style.display = 'flex';
                            }
                        }, 1000);
                    })
                    .catch(err => {
                        console.log('âŒ Service Worker failed:', err);
                        // Create a simple service worker if it doesn't exist
                        const blob = new Blob([
                            `self.addEventListener('install', e => self.skipWaiting());
                             self.addEventListener('activate', e => e.waitUntil(clients.claim()));
                             self.addEventListener('fetch', e => e.respondWith(fetch(e.request)));`
                        ], { type: 'application/javascript' });
                        
                        const url = URL.createObjectURL(blob);
                        navigator.serviceWorker.register(url)
                            .then(() => console.log('âœ… Fallback Service Worker registered'))
                            .catch(e => console.log('âŒ Fallback also failed:', e));
                    });
            }
            
            // For iOS - Show install instructions
            if (/(iPhone|iPad|iPod)/i.test(navigator.userAgent) && !window.navigator.standalone) {
                setTimeout(() => {
                    const iOSInstallDiv = document.createElement('div');
                    iOSInstallDiv.innerHTML = `
                        <div style="position: fixed; top: 20px; left: 20px; right: 20px; background: white; padding: 15px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.15); z-index: 10000; border-left: 4px solid #10b981;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <strong>Install AgriFarmers App</strong><br>
                                    <small>Tap <i class="fas fa-share"></i> Share â†’ "Add to Home Screen"</small>
                                </div>
                                <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; font-size: 20px; cursor: pointer;">Ã—</button>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(iOSInstallDiv);
                    
                    setTimeout(() => {
                        if (iOSInstallDiv.parentElement) {
                            iOSInstallDiv.remove();
                        }
                    }, 10000);
                }, 3000);
            }
            
            // Hide loading screen after 1.5 seconds
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                
                // Initialize app
                if (typeof initApp === 'function') {
                    initApp();
                }
            }, 1500);
        });
        
        // Make install function globally available
        window.installPWA = installPWA;
    </script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen">
        <div class="loader"></div>
        <p class="mt-4 text-gray-600 text-lg">Loading AgriFarmers...</p>
    </div>

    <!-- App Container -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="app-header-content">
                <div class="logo">
                    <i class="fas fa-seedling"></i>
                    <span>AgriFarmers</span>
                </div>
                <div style="display: flex; gap: 15px; align-items: center;">
                    <select id="languageSelect" class="form-control" style="width: auto; padding: 8px 12px; font-size: 14px;">
                        <option value="en">English</option>
                        <option value="hi">à¤¹à¤¿à¤‚à¤¦à¥€</option>
                        <option value="pa">à¨ªà©°à¨œà¨¾à¨¬à©€</option>
                    </select>
                    <button id="logoutBtn" class="btn-primary" style="padding: 8px 15px; font-size: 14px; display: none;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-content">
            <!-- Welcome Page -->
            <div id="welcomePage" class="page active">
                <div class="welcome-screen">
                    <div class="welcome-icon">
                        <i class="fas fa-seedling"></i>
                    </div>
                    <h1 style="font-size: 2.5rem; font-weight: 700; color: #1a1a1a; margin-bottom: 15px;">
                        Welcome to AgriFarmers
                    </h1>
                    <p style="font-size: 1.1rem; color: #666; margin-bottom: 30px; max-width: 600px; margin-left: auto; margin-right: auto;">
                        Your trusted companion for modern farming. Get live weather updates, market prices, and expert farming advice.
                    </p>
                    
                    <!-- Features -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px;">
                        <div class="feature-card">
                            <i class="fas fa-cloud-sun" style="font-size: 30px; color: #3b82f6; margin-bottom: 15px;"></i>
                            <h3 style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;">Live Weather</h3>
                            <p style="color: #666; font-size: 0.9rem;">Accurate weather forecasts and farming alerts for your location.</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-chart-line" style="font-size: 30px; color: #10b981; margin-bottom: 15px;"></i>
                            <h3 style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;">Market Prices</h3>
                            <p style="color: #666; font-size: 0.9rem;">Real-time crop prices and market trends across India.</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-seedling" style="font-size: 30px; color: #8b5cf6; margin-bottom: 15px;"></i>
                            <h3 style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;">Farming Guide</h3>
                            <p style="color: #666; font-size: 0.9rem;">Expert advice on seeds, fertilizers, and crop management.</p>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                        <button onclick="showPage('loginPage')" class="btn-primary" style="padding: 12px 30px;">
                            <i class="fas fa-sign-in-alt"></i> Get Started
                        </button>
                        <button onclick="showPage('signupPage')" class="btn-primary" style="background: white; color: #10b981; border: 2px solid #10b981;">
                            <i class="fas fa-user-plus"></i> Create Account
                        </button>
                    </div>
                    
                    <!-- Install Hint -->
                    <div style="margin-top: 30px; padding: 15px; background: #f0fdf4; border-radius: 10px; border-left: 4px solid #10b981;">
                        <p style="margin: 0; color: #065f46; font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> For best experience, install the app on your device.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Login Page -->
            <div id="loginPage" class="page">
                <div style="max-width: 400px; margin: 0 auto;">
                    <h2 style="font-size: 1.8rem; font-weight: 600; margin-bottom: 30px; text-align: center;">Login</h2>
                    
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">Mobile Number</label>
                        <input type="tel" id="loginMobile" class="form-control" placeholder="Enter 10-digit number" maxlength="10">
                    </div>
                    
                    <button onclick="handleLogin()" class="btn-primary" style="width: 100%; padding: 12px;">
                        <i class="fas fa-sign-in-alt"></i> Send OTP
                    </button>
                    
                    <p style="text-align: center; margin-top: 20px; color: #666;">
                        Don't have an account? 
                        <a onclick="showPage('signupPage')" style="color: #10b981; cursor: pointer; font-weight: 500;">Sign Up</a>
                    </p>
                </div>
            </div>

            <!-- Signup Page -->
            <div id="signupPage" class="page">
                <div style="max-width: 400px; margin: 0 auto;">
                    <h2 style="font-size: 1.8rem; font-weight: 600; margin-bottom: 30px; text-align: center;">Create Account</h2>
                    
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">Full Name</label>
                        <input type="text" id="signupName" class="form-control" placeholder="Enter your name">
                    </div>
                    
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">Mobile Number</label>
                        <input type="tel" id="signupMobile" class="form-control" placeholder="Enter 10-digit number" maxlength="10">
                    </div>
                    
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">State</label>
                        <select id="signupState" class="form-control">
                            <option value="">Select State</option>
                            <option>Punjab</option>
                            <option>Haryana</option>
                            <option>Rajasthan</option>
                            <option>Uttar Pradesh</option>
                        </select>
                    </div>
                    
                    <button onclick="handleSignup()" class="btn-primary" style="width: 100%; padding: 12px;">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                    
                    <p style="text-align: center; margin-top: 20px; color: #666;">
                        Already have an account? 
                        <a onclick="showPage('loginPage')" style="color: #10b981; cursor: pointer; font-weight: 500;">Login</a>
                    </p>
                </div>
            </div>

            <!-- OTP Page -->
            <div id="otpPage" class="page">
                <div style="max-width: 400px; margin: 0 auto;">
                    <h2 style="font-size: 1.8rem; font-weight: 600; margin-bottom: 30px; text-align: center;">OTP Verification</h2>
                    
                    <div style="text-align: center; margin-bottom: 20px;">
                        <p style="color: #666;">Enter the 6-digit OTP sent to</p>
                        <p id="otpNumber" style="font-weight: 600; color: #10b981; font-size: 1.1rem;">+91 XXXXXXXX</p>
                    </div>
                    
                    <div style="display: flex; justify-content: center; gap: 10px; margin-bottom: 30px;">
                        <input type="text" maxlength="1" class="otp-digit" style="width: 50px; height: 60px; text-align: center; font-size: 24px; border: 2px solid #e2e8f0; border-radius: 10px;">
                        <input type="text" maxlength="1" class="otp-digit" style="width: 50px; height: 60px; text-align: center; font-size: 24px; border: 2px solid #e2e8f0; border-radius: 10px;">
                        <input type="text" maxlength="1" class="otp-digit" style="width: 50px; height: 60px; text-align: center; font-size: 24px; border: 2px solid #e2e8f0; border-radius: 10px;">
                        <input type="text" maxlength="1" class="otp-digit" style="width: 50px; height: 60px; text-align: center; font-size: 24px; border: 2px solid #e2e8f0; border-radius: 10px;">
                        <input type="text" maxlength="1" class="otp-digit" style="width: 50px; height: 60px; text-align: center; font-size: 24px; border: 2px solid #e2e8f0; border-radius: 10px;">
                        <input type="text" maxlength="1" class="otp-digit" style="width: 50px; height: 60px; text-align: center; font-size: 24px; border: 2px solid #e2e8f0; border-radius: 10px;">
                    </div>
                    
                    <p style="text-align: center; color: #666; margin-bottom: 10px;">
                        <span id="otpTimer" style="color: #ef4444; font-weight: 600;">02:00</span> remaining
                    </p>
                    
                    <button onclick="verifyOTP()" class="btn-primary" style="width: 100%; padding: 12px; margin-bottom: 15px;">
                        <i class="fas fa-check-circle"></i> Verify OTP
                    </button>
                    
                    <p style="text-align: center; color: #666;">
                        Didn't receive OTP? 
                        <a onclick="resendOTP()" style="color: #10b981; cursor: pointer; font-weight: 500;">Resend</a>
                    </p>
                </div>
            </div>

            <!-- Home Page -->
            <div id="homePage" class="page">
                <div style="margin-bottom: 30px;">
                    <div style="background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 20px; border-radius: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div>
                                <h2 id="welcomeMessage" style="font-size: 1.5rem; font-weight: 600; margin: 0;">Hello, Farmer!</h2>
                                <p id="userLocation" style="opacity: 0.9; margin: 5px 0 0 0; font-size: 0.9rem;">
                                    <i class="fas fa-location-dot"></i> Fetching location...
                                </p>
                            </div>
                            <div style="text-align: right;">
                                <p id="currentDate" style="margin: 0; font-weight: 600;">Today</p>
                                <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9rem;">Good day for farming</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Stats -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <i class="fas fa-temperature-half" style="font-size: 24px; color: #3b82f6; margin-bottom: 10px;"></i>
                        <p style="font-weight: 600; margin: 5px 0;">28Â°C</p>
                        <p style="font-size: 0.8rem; color: #666;">Temperature</p>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <i class="fas fa-droplet" style="font-size: 24px; color: #3b82f6; margin-bottom: 10px;"></i>
                        <p style="font-weight: 600; margin: 5px 0;">65%</p>
                        <p style="font-size: 0.8rem; color: #666;">Humidity</p>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 10px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <i class="fas fa-wheat-awn" style="font-size: 24px; color: #10b981; margin-bottom: 10px;"></i>
                        <p style="font-weight: 600; margin: 5px 0;">â‚¹2,150</p>
                        <p style="font-size: 0.8rem; color: #666;">Wheat Price/Q</p>
                    </div>
                </div>
                
                <!-- Features -->
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 20px;">Quick Access</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div class="feature-card" onclick="openFeature('weather')" style="cursor: pointer;">
                            <i class="fas fa-cloud-sun" style="font-size: 30px; color: #3b82f6; margin-bottom: 15px;"></i>
                            <h4 style="font-weight: 600; margin-bottom: 10px;">Weather Forecast</h4>
                            <p style="color: #666; font-size: 0.9rem;">Detailed weather information and alerts</p>
                        </div>
                        <div class="feature-card" onclick="openFeature('market')" style="cursor: pointer;">
                            <i class="fas fa-chart-line" style="font-size: 30px; color: #10b981; margin-bottom: 15px;"></i>
                            <h4 style="font-weight: 600; margin-bottom: 10px;">Market Prices</h4>
                            <p style="color: #666; font-size: 0.9rem;">Live crop prices across markets</p>
                        </div>
                        <div class="feature-card" onclick="openFeature('seeds')" style="cursor: pointer;">
                            <i class="fas fa-seedling" style="font-size: 30px; color: #8b5cf6; margin-bottom: 15px;"></i>
                            <h4 style="font-weight: 600; margin-bottom: 10px;">Seeds & Fertilizers</h4>
                            <p style="color: #666; font-size: 0.9rem;">Expert recommendations for your crops</p>
                        </div>
                    </div>
                </div>
                
                <!-- Farming Tip -->
                <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 15px; border-radius: 10px; margin-bottom: 30px;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <i class="fas fa-lightbulb" style="color: #f59e0b; font-size: 20px;"></i>
                        <h4 style="font-weight: 600; margin: 0;">Today's Farming Tip</h4>
                    </div>
                    <p id="farmingTip" style="margin: 0; color: #92400e;">
                        Good weather conditions for irrigation and fertilization. Monitor soil moisture regularly.
                    </p>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p style="margin: 0;">Â© 2024 AgriFarmers. All rights reserved.</p>
            <p style="margin: 5px 0 0 0; font-size: 0.9rem; opacity: 0.9;">Your trusted farming companion</p>
        </footer>
        
        <!-- PWA Install Button -->
        <button id="pwa-install-button" onclick="installPWA()">
            <i class="fas fa-download"></i>
            <span>Install App</span>
        </button>
    </div>

    <!-- App Script -->
    <script>
        // Page Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // Update current date
            if (pageId === 'homePage') {
                const date = new Date();
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                document.getElementById('currentDate').textContent = date.toLocaleDateString('en-US', options);
            }
            
            // Show/hide logout button
            if (pageId === 'homePage') {
                document.getElementById('logoutBtn').style.display = 'block';
            } else {
                document.getElementById('logoutBtn').style.display = 'none';
            }
        }
        
        // Auth Functions
        function handleLogin() {
            const mobile = document.getElementById('loginMobile').value;
            if (mobile.length === 10 && /^\d+$/.test(mobile)) {
                document.getElementById('otpNumber').textContent = '+91 ' + mobile;
                showPage('otpPage');
                startOTPTimer();
            } else {
                alert('Please enter a valid 10-digit mobile number');
            }
        }
        
        function handleSignup() {
            const name = document.getElementById('signupName').value;
            const mobile = document.getElementById('signupMobile').value;
            const state = document.getElementById('signupState').value;
            
            if (!name) {
                alert('Please enter your name');
                return;
            }
            
            if (mobile.length !== 10 || !/^\d+$/.test(mobile)) {
                alert('Please enter a valid 10-digit mobile number');
                return;
            }
            
            if (!state) {
                alert('Please select your state');
                return;
            }
            
            document.getElementById('otpNumber').textContent = '+91 ' + mobile;
            document.getElementById('welcomeMessage').textContent = 'Hello, ' + name + '!';
            showPage('otpPage');
            startOTPTimer();
        }
        
        // OTP Functions
        let otpTimer;
        function startOTPTimer() {
            let timeLeft = 120; // 2 minutes
            const timerElement = document.getElementById('otpTimer');
            
            clearInterval(otpTimer);
            otpTimer = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(otpTimer);
                    timerElement.textContent = '00:00';
                }
                timeLeft--;
            }, 1000);
        }
        
        function verifyOTP() {
            // Demo OTP: 123456
            showPage('homePage');
            clearInterval(otpTimer);
            
            // Show success message
            showToast('Login successful! Welcome to AgriFarmers', 'success');
        }
        
        function resendOTP() {
            startOTPTimer();
            showToast('New OTP sent to your mobile', 'info');
        }
        
        // Feature Functions
        function openFeature(feature) {
            const messages = {
                weather: 'Weather forecast loaded. Cloudy with chance of rain in evening.',
                market: 'Market prices loaded. Wheat: â‚¹2,150, Rice: â‚¹1,850, Cotton: â‚¹6,200',
                seeds: 'Seed recommendations: Use HD-2967 for wheat, PR-114 for rice'
            };
            
            showToast(messages[feature] || 'Feature opened', 'success');
        }
        
        // Logout
        document.getElementById('logoutBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to logout?')) {
                showPage('welcomePage');
                showToast('Logged out successfully', 'info');
            }
        });
        
        // Initialize App
        function initApp() {
            console.log('ðŸšœ AgriFarmers App Started');
            
            // Set current date
            const date = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = date.toLocaleDateString('en-US', options);
            
            // Try to get location
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        document.getElementById('userLocation').innerHTML = 
                            `<i class="fas fa-location-dot"></i> Location detected`;
                    },
                    () => {
                        document.getElementById('userLocation').innerHTML = 
                            `<i class="fas fa-location-dot"></i> Enable location for better experience`;
                    }
                );
            }
        }
        
        // Make functions available globally
        window.showPage = showPage;
        window.handleLogin = handleLogin;
        window.handleSignup = handleSignup;
        window.verifyOTP = verifyOTP;
        window.resendOTP = resendOTP;
        window.openFeature = openFeature;
        window.initApp = initApp;
    </script>
</body>
</html>
